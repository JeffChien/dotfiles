#+title:  reademe
#+PROPERTY: header-args :tangle .config/tmux/tmux.conf :mkdirp yes

* Table of contents :TOC:
- [[#tmux][tmux]]
  - [[#config][config]]
- [[#gnu-stow][Gnu stow]]
- [[#tagging][Tagging]]

* tmux
** config
*** before
**** packages
#+begin_src conf
# TMUX_PLUGIN_MANAGER_PATH is needed
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-open'
set -g @plugin 'tmux-plugins/tmux-pain-control'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
# copycat doesn't work well with tmux >= 2.4
#set -g @plugin 'tmux-plugins/tmux-copycat'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'jimeh/tmux-themepack'
set -g @plugin 'tmux-plugins/tmux-sessionist'
set -g @plugin 'jbnicolai/tmux-fpp'
set -g @plugin 'tmux-plugins/tmux-urlview'
set -g @plugin 'dracula/tmux'
#+end_src

**** options
#+begin_src conf
# don't spawn login shell, becaulse it has been set by terminal emulator.
set -g default-command "$SHELL"
set -g set-clipboard on
set -g mouse on # allowing mouse to select to clipboard and resize pane

# Make switching to cmd mode in zsh quick!
set -g repeat-time 250

## update the TERM variable of terminal emulator when creating a new session or attaching a existing session
set -g update-environment 'DISPLAY \
      SSH_ASKPASS \
      SSH_AGENT_PID \
      SSH_CONNECTION \
      WINDOWID \
      XAUTHORITY \
      TERM'

# status bar positon top
set -g status-position top

# Start pane numbering at 1
set -g base-index 1

# Allow xterm titles in terminal window, terminal scrolling with scrollbar, and setting overrides of C-Up, C-Down, C-Left, C-Right
set -g terminal-overrides "xterm*:XT:smcup@:rmcup@:kUP5=\eOA:kDN5=\eOB:kLFT5=\eOD:kRIT5=\eOC"

# vi-style controls in copy mode
set -g mode-keys vi

set -g word-separators ' @(){}'

set -g @themepack 'powerline/block/orange'
#+end_src

**** others
#+begin_src conf

# when data input speed faster than terminal display rate, instead update everything to screen
# tmux can update screen every interval time. with proper value, can workaround for terminal
# like gnome-terminal and terminator freeze when input data is large.

#setw -g c0-change-trigger 10   # default 250
#setw -g c0-change-interval 250 # default 100

# ==============================================
# ===   Nesting local and remote sessions     ===
# ==============================================

# Session is considered to be remote when we ssh into host
if-shell 'test -n "$SSH_CLIENT"' \
    'source-file ~/.tmux/tmux.remote.conf'

bind -T root F12  \
    set prefix None \;\
    set key-table off \;\
    source-file "${TMUX_PLUGIN_MANAGER_PATH}/tmux-themepack/default.tmuxtheme" \;\
    if -F '#{pane_in_mode}' 'send-keys -X cancel' \;\
    refresh-client -S \;\

bind -T off F12 \
  set -u prefix \;\
  set -u key-table \;\
  source-file "${TMUX_PLUGIN_MANAGER_PATH}/tmux-themepack/powerline/block/orange.tmuxtheme" \;\
  refresh-client -S

#+end_src

*** after
**** key-bindings

Normal mode
| key                    | description                              | PS                 |
|------------------------+------------------------------------------+--------------------|
| M                      | alt                                      |                    |
| Ctrl - s               | prefix                                   |                    |
| M -Ô∏è up                 | copy mode                                |                    |
| prefix + C - p         | previous window                          | from tmux-sensible |
| prefix + C - + n       | next window                              | from tmux-sensible |
| prefix + C - + s       | choose session                           |                    |
| prefix + C - + o       | rotate panes                             |                    |
| prefix + C - + p       | next layout                              |                    |
| prefix + C - + 0       | show clock                               |                    |
| prefix + C - + =       | paste last yanked text                   |                    |
| prefix + C - + m       | maximize pane                            |                    |
| prefix - ;             | command mode                             |                    |
| prefix - x             | confirm before kill a pane               |                    |
| prefix + C - h         | focus pane left                          | from pane-control  |
| prefix + C - j         | focus pane down                          | from pane-control  |
| prefix + C - k         | focus pane up                            | from pane-control  |
| prefix + C - l         | focus pane right                         | from pane-control  |
| prefix + shift + C - h | resize pane left                         | from pane-control  |
| prefix + shift + C - j | resize pane down                         | from pane-control  |
| prefix + shift + C - k | resize pane up                           | from pane-control  |
| prefix + shift + C - l | resize pane right                        | from pane-control  |
| prefix - vbar          | split pane into 2 vertically             | from pane-control  |
| prefix - hbar          | split pane into 2 horizonally            | from pane-control  |
| prefix - \             | split pane into 2 vertically full width  | from pane-control  |
| prefix - _             | split pane into 2 vertically full height | from pane-control  |
| prefix - <             | move window left                         | from pane-control  |
| prefix - >             | move window left                         | from pane-control  |
| prefix - y             | copy text from command line to clipboard | from tmux-yank     |
| prefix - Y             | copy pwd to clipboard                    | from tmux-yank     |
| prefix - I             | tpm install all packages                 | from tpm           |
| prefix - U             | tpm update all packages                  | from tpm           |


copy mode
| key           | description                     | PS             |
|---------------+---------------------------------+----------------|
| M - up        | scroll up                       |                |
| M - down      | scroll down                     |                |
| M - page up   | scroll half page up             |                |
| M - page down | scroll half page down           |                |
| page up       | scroll page up                  |                |
| page down     | scroll page down                |                |
| y             | copy selection to clipboard     | from tmux-yank |
| Y             | copy and immediately paste      | from tmux-yank |
| o             | open selected text              | from tmux-open |
| C - o         | open selected text with $EDITOR | from tmux-open |
| shift - s     | google the selected text        | from tmux-open |

#+begin_src conf
# Set the prefix key to Ctrl-z(qwerty) Ctrl-s(dvorak)
set -g prefix C-s

# trigger copy mode by
bind -n M-Up copy-mode

# Scroll up/down by 1 line, half screen, whole screen
bind -T copy-mode-vi M-Up              send-keys -X scroll-up
bind -T copy-mode-vi M-Down            send-keys -X scroll-down
bind -T copy-mode-vi M-PageUp          send-keys -X halfpage-up
bind -T copy-mode-vi M-PageDown        send-keys -X halfpage-down
bind -T copy-mode-vi PageUp            send-keys -X page-up
bind -T copy-mode-vi PageDown          send-keys -X page-down


# Ctrl-S: choose session
#bind s choose-session
bind C-S choose-session

# Ctrl-O: Rotate pane
bind o rotate-window

# Ctrl-P: Next layout
bind p next-layout

# Ctrl-D: Detach
bind d detach-client

# Ctrl-0: Clock!
bind 0 clock-mode

# Ctrl-=: choose and past buffer
bind = choose-buffer -F '#{buffer_sample}'

# toggle maximize pane
bind m resize-pane -Z

bind \; command-prompt

bind x confirm-before kill-pane

# When scrolling with mouse wheel, reduce number of scrolled rows per tick to "2" (default is 5)
bind -T copy-mode-vi WheelUpPane       select-pane \; send-keys -X -N 2 scroll-up
bind -T copy-mode-vi WheelDownPane     select-pane \; send-keys -X -N 2 scroll-down
#+end_src
**** the very end
#+begin_src conf
run-shell "$TMUX_PLUGIN_MANAGER_PATH/tpm/tpm"
#+end_src
* Gnu stow
#+begin_src pattern :tangle .stow-local-ignore
#+end_src

* Tagging
#+begin_src tag :tangle TAGS
linux
darwin
#+end_src
